<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        *{
    color:white;
    text-decoration: none;
}
.details{
    margin-left: 15px;
    margin-right: 15px;
    scroll-behavior: smooth;
}
.fontStyle{
    font-size: 17px;
}
.navbar{
    background: linear-gradient(45deg,rgb(0, 0, 0),black);
    font-family: calibri;
    padding-right: 15px;
    padding-left: 15px;
    border-bottom: 2px solid white;
    width: 100%;
}
.navdiv{
    display: flex; align-items: center;
    justify-content: space-between;
}
.navdiv ul{
    position: absolute;
    right: 0px;
    align-items: center;
    padding: 15px 10px 0px 10px;
}
.logo a{
    font-size: 30px;
    align-items: center;

    font-weight: 600; color: white;
    text-decoration: none;
}
li{
    list-style: none; display: inline-block;
}
li a{
    text-decoration: none;
    color: white;
    font-size: 20px;
    font-weight: bold;
    margin-right: 25px;
    cursor: pointer;
}

li:hover{
    background: linear-gradient(45deg, red,black);
    padding: 5px;
    border-radius: 4px;
}
@media only screen and (max-width: 591px) {
    .logo{
        display: none;
    }
    .navdiv ul{
        position: relative;
        display: flex;
        justify-content: space-around;
    }
    .graphDisplayStyle{
        display: block !important;
        width: 270px;
        align-items: center;
        margin: 0px auto;
    }
}
.graphDisplayStyle{
    display: flex;
    justify-content: space-around;
}

.stressPercentage{

min-width: 270px;
min-height: 250px;
background: white;
}
.agrresiveDistribution{
    /* position: absolute; */
    min-width: 270px;
    min-height: 250px;
    background: red;
    margin-right: 10px;
    margin-top: 10px;
}
.aggressivePercentage{
width: 249px;
height: 250px;
background: #FFFFFF;
right:0;
}

.completeResult{
    align-items: center;
    padding-top:-10px ;
}

.drivingHistory{
    padding: 40px 40px;
    margin: 0 auto;
}
@media screen and (min-width: 1300px) {
    .drivingHistory {
    padding: 85px;
    }
}
table {
    border-collapse: collapse;
    width: 100%;
    max-width: 1200px;
    align-items: center;
    margin: 0 auto;
    text-align: center;

}

thead th{
    border: 1px solid white;
    border-top: none;
}
tbody tr {
    border: 1px solid white;

}

tbody td, th{
    border-left: 1px solid white;
    border-right: 1px solid white;
}
tbody:last-child tr{
    height: 15px;
    border-bottom: none;
}


/* RealTime Page */
.realTimeStress{
    width:100%;
    background-color: #FFFFFF;
    min-height: 270px;
    height: auto;
    margin: 15px auto;
}

.agressiveScroll{
    width:100%;
    margin: 15px auto;
    background-color: rgb(45, 235, 45);
    height: 40px;
    border-radius: 12px;
}

.instantlastStyle{
    margin: 45px auto;
}
.aggresiveVsStress{
    width: 55%;
    background-color: rgb(90, 224, 28);
    min-height: 270px;
    height: auto;
}
.titleDisplay{
    height: 270px;
    background:linear-gradient(20deg,white,rgb(90, 224, 28));
    margin-left: 15px;
    margin-right: 30px;
    width: 90px;
}

.instantResult{
    padding-top: 10px;
    font-size: 20px;
}
#instantAdvice, #instantEmoji{

    font-size: 30px;
    color: gray;
    font-weight: 700;
    font-family: 'Times New Roman', Times, serif;
    padding-right: 5px;

}
    </style>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-black details">

    <nav class="navbar">
		<div class="navdiv d-flex ">
			<div class="logo"><a href="#">DriveInsight</a> </div>
			<ul>
            <li><a href="">Login</a></li>
            <li><a href="/result">Driving Sessions</a></li>
				<li><a href="/real_time">Real time</a></li>
				<li><a href="">Support</a></li>
			</ul>
		</div>
	</nav>
    <div class="realTimeStress">
        <canvas id="speedChart" width="800" height="400"></canvas>
    </div>
    <div class="realTimeStress">
        <canvas id="bpmChart" width="800" height="400"></canvas>
    </div>
    <div class="realTimeStress">
        <canvas id="ibiChart" width="800" height="400"></canvas>
    </div>
    <div class="agressiveScroll">

    </div>
    <div class="d-flex instantLastStyle pt-4">
            <div class="aggresiveVsStress">

            </div>
            <div class="titleDisplay">

            </div>

        <div class="instantResult ">
            <p>Stress
                <span id="instantStress"></span>
            </p>
            <p>Driving Style :
                <span id="instantAggression"></span>
            </p>
            <p>Risk :
                <span id="instantRisk"></span>
            </p>
            <p>
                <span id="instantEmoji"> üçµ</span>
                <span id="instantAdvice">Slow Down</span>
            </p>
        </div>
    </div>
    <script>
        var ctxSpeed = document.getElementById('speedChart').getContext('2d');
        var ctxBpm = document.getElementById('bpmChart').getContext('2d');
        let speed = {{speed | safe}}
        let bpm = {{bpm | safe}}
        let ibi = {{ibi | safe}}
        let time = Array.from({ length: speed.length }, (_, index) => index + 1);
        var speedChart = new Chart(ctxSpeed, {
            type: 'line',
            data: {
                labels: time.slice(1, 1000),
                datasets: [{
                    label: 'Speed',
                    data: speed.slice(1, 1000),
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    xAxes: [{
                        type: 'linear',
                        position: 'bottom',
                        scaleLabel: {
                            display: true,
                            labelString: 'Time'
                        }
                    }],
                    yAxes: [{
                        type: 'linear',
                        position: 'left',
                        scaleLabel: {
                            display: true,
                            labelString: 'Value'
                        },
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });

        let start_index = 0
        let end_index = 1000

        function updateChart(chart, newData, newTime) {
            chart.data.datasets[0].data = newData;
            chart.data.labels = newTime;
            chart.update();
        }

        function speedEverySecond() {
        start_index = start_index+10
        end_index = end_index+10
        if (start_index<speed.length){
        updateChart(speedChart, speed.slice(start_index, end_index), time.slice(start_index, end_index))
        setTimeout(speedEverySecond, 1000);
        }
    }
    speedEverySecond();

    let start_index_bpm = 0
    let end_index_bpm = 1000
    var bpmChart = new Chart(ctxBpm, {
            type: 'line',
            data: {
                labels: time.slice(1, 1000),
                datasets: [{
                    label: 'bpm',
                    data: bpm.slice(1, 1000),
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    xAxes: [{
                        type: 'linear',
                        position: 'bottom',
                        scaleLabel: {
                            display: true,
                            labelString: 'Time'
                        }
                    }],
                    yAxes: [{
                        type: 'linear',
                        position: 'left',
                        scaleLabel: {
                            display: true,
                            labelString: 'Value'
                        },
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });


        function bpmEverySecond() {
        start_index_bpm = start_index_bpm+10
        end_index_bpm = end_index_bpm+10
        if (start_index_bpm<bpm.length){
        updateChart(bpmChart, bpm.slice(start_index_bpm, end_index_bpm),
        time.slice(start_index_bpm, end_index_bpm))
        setTimeout(bpmEverySecond, 1000);
        }
    }
    bpmEverySecond();

    let start_index_ibi = 0
    let end_index_ibi = 1000
    var ctxIbi = document.getElementById('ibiChart').getContext('2d');
    var ibiChart = new Chart(ctxIbi, {
            type: 'line',
            data: {
                labels: time.slice(1, 1000),
                datasets: [{
                    label: 'ibi',
                    data: ibi.slice(1, 1000),
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    xAxes: [{
                        type: 'linear',
                        position: 'bottom',
                        scaleLabel: {
                            display: true,
                            labelString: 'Time'
                        }
                    }],
                    yAxes: [{
                        type: 'linear',
                        position: 'left',
                        scaleLabel: {
                            display: true,
                            labelString: 'Value'
                        },
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                }
            }
        });


        function ibiEverySecond() {
        start_index_ibi = start_index_ibi+10
        end_index_ibi = end_index_ibi+10
        if (start_index_ibi<ibi.length){
        updateChart(ibiChart, ibi.slice(start_index_ibi, end_index_ibi), time.slice(start_index_ibi, end_index_ibi))
        setTimeout(ibiEverySecond, 1000);
        }
    }
    ibiEverySecond();


    const currentDate = new Date();
const formattedDate = `${currentDate.getDate()}-${currentDate.getMonth()+1}-${currentDate.getFullYear()}`;
console.log(formattedDate);
document.getElementById('date').innerText=formattedDate;

        </script>
</body>
</html>